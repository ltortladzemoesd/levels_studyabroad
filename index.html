<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Levels Academy – University Map (Clean, with Country Labels)</title>

<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<style>
  html, body { height:100%; margin:0; font-family:ui-sans-serif,system-ui,Arial; background:#fff; }
  #app { display:grid; grid-template-rows:auto 1fr; height:100%; }
  header {
    padding:10px 14px; background:#2B445B; color:#fff;
    display:grid; grid-template-columns:1fr auto auto auto; gap:10px; align-items:center;
  }
  header h1{ margin:0; font-size:16px; font-weight:600; }
  .control{ display:inline-flex; gap:8px; align-items:center; }
  .control label{ font-size:13px; opacity:.9 }
  .control select, .control input{
    border:none; padding:6px 8px; border-radius:8px; outline:none; background:#eef2f4;
  }
  #map{ width:100%; height:100%; }

  /* Subtle, clean look for the basemap */
  .leaflet-tile {
    filter: grayscale(100%) contrast(95%) brightness(104%);
  }

  /* Legend */
  .legend {
    position:absolute; bottom:12px; left:12px; background:white; padding:10px 12px;
    border-radius:12px; box-shadow:0 10px 24px rgba(0,0,0,.08); font-size:13px;
  }
  .legend .row{ display:flex; align-items:center; gap:8px; margin:6px 0; }
  .dot{ width:12px; height:12px; border-radius:50%; display:inline-block; }
  .dot.t1{ background:#23B899 } /* 1–50 */
  .dot.t2{ background:#FDE200 } /* 51–200 */
  .dot.t3{ background:#F66E6E } /* 201+ */

  .leaflet-control-zoom{ box-shadow:none !important; }
  .leaflet-popup-content{ font-size:14px; }
  .muted{ color:#667; font-size:13px; }
</style>
</head>
<body>
<div id="app">
  <header>
    <h1>QS Europe 2025 • Top Universities</h1>

    <div class="control">
      <label for="country">Country</label>
      <select id="country"><option value="ALL">All</option></select>
    </div>

    <div class="control">
      <label for="tier">Rank</label>
      <select id="tier">
        <option value="ALL">All</option>
        <option value="T1">1–50</option>
        <option value="T2">51–200</option>
        <option value="T3">201+</option>
      </select>
    </div>

    <div class="control">
      <label for="q">Search</label>
      <input id="q" type="search" placeholder="University name…" />
    </div>
  </header>

  <div id="map"></div>
</div>

<div class="legend">
  <div><strong>Legend</strong></div>
  <div class="row"><span class="dot t1"></span> 1–50</div>
  <div class="row"><span class="dot t2"></span> 51–200</div>
  <div class="row"><span class="dot t3"></span> 201+</div>
</div>

<script>
// ---------- DATA (demo subset; add globalRank when available) ----------
const universities = [
  {euRank:1,  globalRank:7,  name:"ETH Zurich – Swiss Federal Institute of Technology", country:"Switzerland", lat:47.3769, lng:8.5417, city:"Zurich"},
  {euRank:2,  globalRank:2,  name:"Imperial College London", country:"United Kingdom", lat:51.4988, lng:-0.1749, city:"London"},
  {euRank:3,  globalRank:3,  name:"University of Oxford", country:"United Kingdom", lat:51.7548, lng:-1.2544, city:"Oxford"},
  {euRank:4,  globalRank:5,  name:"University of Cambridge", country:"United Kingdom", lat:52.2043, lng:0.1149, city:"Cambridge"},
  {euRank:5,  globalRank:9,  name:"UCL (University College London)", country:"United Kingdom", lat:51.5246, lng:-0.1340, city:"London"},
  {euRank:9,  globalRank:24, name:"Université PSL (Paris Sciences & Lettres)", country:"France", lat:48.8470, lng:2.3459, city:"Paris"},
  {euRank:10, globalRank:27, name:"EPFL – École polytechnique fédérale de Lausanne", country:"Switzerland", lat:46.5191, lng:6.5668, city:"Lausanne"},
  {euRank:11, globalRank:37, name:"Technical University of Munich (TUM)", country:"Germany", lat:48.1486, lng:11.5685, city:"Munich"},
  {euRank:13, globalRank:85, name:"Lund University", country:"Sweden", lat:55.7047, lng:13.1910, city:"Lund"},
  {euRank:15, globalRank:49, name:"Delft University of Technology", country:"Netherlands", lat:51.9998, lng:4.3739, city:"Delft"},
  {euRank:17, globalRank:53, name:"University of Amsterdam", country:"Netherlands", lat:52.3557, lng:4.9557, city:"Amsterdam"},
  {euRank:18, globalRank:59, name:"LMU Munich", country:"Germany", lat:48.1500, lng:11.5800, city:"Munich"}
];

// Helpers
function tier(euRank){ if(euRank<=50) return "T1"; if(euRank<=200) return "T2"; return "T3"; }
function color(t){ return t==="T1"?"#23B899":(t==="T2"?"#FDE200":"#F66E6E"); }
function rankLine(u){
  let s = `Rank #${u.euRank} in Europe`;
  if (Number.isFinite(u.globalRank)) s += ` • Rank #${u.globalRank} Globally`;
  return s;
}

// ---------- MAP (Carto Positron with labels = clean borders + country names) ----------
const map = L.map('map', { zoomControl:true, minZoom:3, maxZoom:7, worldCopyJump:true })
  .setView([51.2, 10.4], 5);

// Carto Positron (clean, labeled). This shows country borders + names with very light roads.
L.tileLayer(
  "https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png",
  { attribution: "&copy; OpenStreetMap &copy; CARTO", detectRetina: true }
).addTo(map);

// Controls
const countryEl = document.getElementById('country');
const tierEl = document.getElementById('tier');
const qEl = document.getElementById('q');

[...new Set(universities.map(u=>u.country))].sort().forEach(c=>{
  const opt = document.createElement('option'); opt.value=c; opt.textContent=c; countryEl.appendChild(opt);
});

let layer = L.layerGroup().addTo(map);

function draw(){
  layer.clearLayers();
  const cf = countryEl.value, tf = tierEl.value, q = qEl.value.trim().toLowerCase();

  const filtered = universities.filter(u=>{
    const t = tier(u.euRank);
    const okCountry = (cf==="ALL" || u.country===cf);
    const okTier = (tf==="ALL" || t===tf);
    const okSearch = !q || u.name.toLowerCase().includes(q);
    return okCountry && okTier && okSearch;
  });

  filtered.forEach(u=>{
    const t = tier(u.euRank);
    const marker = L.circleMarker([u.lat,u.lng], {
      radius: 7, weight: 1.2, color: "#1d2a31", fillColor: color(t), fillOpacity: 0.92
    }).bindPopup(`
      <div>
        <div style="font-weight:700; margin-bottom:4px;">${rankLine(u)}</div>
        <div>${u.name}</div>
        <div class="muted">${u.city}, ${u.country}</div>
      </div>
    `);
    marker.addTo(layer);
  });

  if (filtered.length){
    const b = L.latLngBounds(filtered.map(u=>[u.lat,u.lng]));
    map.fitBounds(b.pad(0.18), { animate:false });
  }
}
countryEl.addEventListener('change', draw);
tierEl.addEventListener('change', draw);
qEl.addEventListener('input', ()=>{ if(window.__d)clearTimeout(window.__d); window.__d=setTimeout(draw,180); });

draw();
</script>
</body>
</html>

